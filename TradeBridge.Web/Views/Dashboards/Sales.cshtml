@model TradeBridge.Web.Models.PowerBIDashboardViewModel
@{
    ViewData["Title"] = Model.Title;
}

<div class="container-fluid">
    <h1 class="mt-4">@Model.Title</h1>
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a asp-controller="Home" asp-action="Index">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">Sales Dashboard</li>
        </ol>
    </nav>

    <div class="card mb-4">
        <div class="card-header d-flex justify-content-between align-items-center">
            <div>
                <i class="fas fa-chart-line me-1"></i>
                Sales Analytics
            </div>
            <div>
                <button class="btn btn-primary btn-sm" id="fullScreenBtn">
                    <i class="fas fa-expand"></i> Full Screen
                </button>
            </div>
        </div>
        <div class="card-body">
            <!-- Power BI Embed Container -->
            <div id="powerbi-embed-container" style="height: 700px;"></div>
        </div>
    </div>
</div>

@section Scripts {
    <!-- Power BI JavaScript SDK -->
    <script src="https://cdn.jsdelivr.net/npm/powerbi-client/dist/powerbi.min.js"></script>
    <script>
        // Power BI Report Embedding
        document.addEventListener('DOMContentLoaded', function () {
            const embedContainer = document.getElementById('powerbi-embed-container');
            const models = window['powerbi-client'].models;
            
            const config = {
                type: 'report',
                tokenType: models.TokenType.Embed,
                accessToken: '@Model.EmbedToken',
                embedUrl: '@Model.EmbedUrl',
                id: '@Model.ReportId',
                permissions: models.Permissions.All,
                settings: {
                    filterPaneEnabled: true,
                    navContentPaneEnabled: true
                }
            };
            
            // Embed the report
            const report = powerbi.embed(embedContainer, config);
            
            // Full screen button
            document.getElementById('fullScreenBtn').addEventListener('click', function() {
                report.fullscreen();
            });
        });
    </script>
} 